create or replace PACKAGE PACKAGE_ORDER_LIST
AS
    PROCEDURE ADD_PRODUCT_TO_ORDER_LIST(PICK_ID INT, O_ID INT, P_ID INT, UN INT, LOC_BIN ORDER_LIST.BIN%TYPE, LOC_ZONE ORDER_LIST.ZONE%TYPE);
    PROCEDURE MOVE_PRODUCT_TO_NEW_PLACE(CURR_ID INT, O_ID INT, P_ID INT, UN INT, OLD_BIN ORDER_LIST.BIN%TYPE, OLD_ZONE ORDER_LIST.ZONE%TYPE, NEW_BIN ORDER_LIST.BIN%TYPE, NEW_ZONE ORDER_LIST.ZONE%TYPE);
    PROCEDURE MOVE_TOTE_TO_STAGE(P_ID NUMBER, EMP_ID INT, TOTE_BIN APPROVED_ZONE.BIN%TYPE, TOTE_ZONE APPROVED_ZONE.ZONE%TYPE, STAGE_BIN APPROVED_ZONE.BIN%TYPE, STAGE_ZONE APPROVED_ZONE.ZONE%TYPE);

END PACKAGE_ORDER_LIST;

create or replace PACKAGE BODY PACKAGE_ORDER_LIST
AS
    
    PROCEDURE MOVE_TOTE_TO_STAGE(P_ID NUMBER, EMP_ID INT, TOTE_BIN APPROVED_ZONE.BIN%TYPE, TOTE_ZONE APPROVED_ZONE.ZONE%TYPE, STAGE_BIN APPROVED_ZONE.BIN%TYPE, STAGE_ZONE APPROVED_ZONE.ZONE%TYPE)
    IS
    
    ROW_ID ORDER_LIST.ID%TYPE;
    O_ID ORDER_LIST.ORDER_ID%TYPE;

    BEGIN
        SELECT ID, ORDER_ID
        INTO ROW_ID, O_ID
        FROM ORDER_LIST
        WHERE PRODUCT_ID = P_ID
            AND BIN LIKE TOTE_BIN
            AND ZONE LIKE TOTE_ZONE
            AND ROWNUM = 1;

        PACKAGE_ORDER_LIST.MOVE_PRODUCT_TO_NEW_PLACE(ROW_ID, O_ID, P_ID, 1, TOTE_BIN, TOTE_ZONE, STAGE_BIN, STAGE_ZONE);

        EXCEPTION
        WHEN no_data_found THEN
            DBMS_OUTPUT.PUT_LINE('No Pick Item Found');
    END;

    PROCEDURE ADD_PRODUCT_TO_ORDER_LIST(PICK_ID INT, O_ID INT, P_ID INT, UN INT, LOC_BIN ORDER_LIST.BIN%TYPE, LOC_ZONE ORDER_LIST.ZONE%TYPE)
    IS
    BEGIN
    INSERT INTO ORDER_LIST(ID, ORDER_ID, PRODUCT_ID, UNITS, BIN, ZONE)
    VALUES(PICK_ID, O_ID, P_ID, UN, LOC_BIN, LOC_ZONE);
    END;

    PROCEDURE MOVE_PRODUCT_TO_NEW_PLACE(CURR_ID INT, O_ID INT, P_ID INT, UN INT, OLD_BIN ORDER_LIST.BIN%TYPE, OLD_ZONE ORDER_LIST.ZONE%TYPE, NEW_BIN ORDER_LIST.BIN%TYPE, NEW_ZONE ORDER_LIST.ZONE%TYPE)
    IS   
    BEGIN
        UPDATE ORDER_LIST
        SET BIN = NEW_BIN,
            ZONE = NEW_ZONE
        WHERE CURR_ID = ID
            AND ORDER_ID = O_ID 
            AND PRODUCT_ID = P_ID
            AND OLD_BIN LIKE BIN
            AND OLD_ZONE LIKE ZONE;
    END;
END;
